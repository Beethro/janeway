{% load static from staticfiles %}
{% load svg from press_url %}
{% load roles %}
{% load i18n %}
{% load hooks %}

<!--<div class="container-fluid">
        {% if request.journal %}
        {% if request.journal.header_image %}
            <img src="{{ request.journal.header_image.url }}" class="img-fluid">
        {% else %}
            {% if request.journal.code == "JFM" or request.journal.code == "JFMT" %}
                <img class=float-left" src="{% static "TUW2/img/jfm_header.png" %}">
            {% elif request.journal.code == "OES" or request.journal.code == "OEST" %}
                <img class=float-left" src="{% static "TUW2/img/oes_header.png" %}">
            {% else %}
                <img class=float-left" src="{% static "TUW2/img/header.png" %}">
            {% endif %}
        {% endif %}
    {% else %}
        <a href="/">{% svg request.press_cover %}</a>
    {% endif %}
    </div>-->

<div class="container-fluid">
    <div class="row mb-1" id="header">
        {% if request.journal.code == "JFM" or request.journal.code == "JFMT" %}
            <div class="col d-none d-sm-block">
                <img style="margin-top: -1px;" src="{% static "TUWJFM/img/jfm_label_576x68.png" %}">
            </div>
            <div class="col d-none d-lg-block" style="text-align: center;">
                <img src="{% static "TUWJFM/img/jfm_logo_cropped_transparent.png" %}">
            </div>
            <div class="col d-none d-xl-block align-self-end" style="text-align: right;"> 
                <img src="{% static "TUWJFM/img/TU_Wien_Bibliothek_250x53.png" %}">
            </div>
            {% endif %}
            <svg version="1.1" id="tuw-logo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 97 97" style="enable-background:new 0 0 97 97;" xml:space="preserve">
                <g>
                    <path style="fill:#006699;" d="M86.5,1c5.2,0,9.5,4.3,9.5,9.5l0,76c0,5.3-4.3,9.5-9.5,9.5h-76C5.3,96,1,91.7,1,86.5l0-76C1,5.3,5.3,1,10.5,1
                        H86.5z"></path>
                    <path style="fill: #FFF; fill-opacity: 0.4" d="M21.1,23.6h10.1v33.7H21.1V23.6z M8.3,10.5h35.5v10.1H8.3V10.5z M29.7,69.6h-3.4l-2.6,10.5l-3.1-10.5h-2.4
                        l-3.1,10.5l-2.6-10.5H9.2l4.5,16.7h2.7l3.1-10.1l3.1,10.1h2.7L29.7,69.6z M86.3,86.3V69.6h-3.3v10.2l-6.6-10.2h-2.9v16.7h3.3V76
                        l6.6,10.3H86.3z M63,86.3v-2.9h-7.7v-4.1h6.6v-2.9h-6.6v-3.9H63v-2.9h-11v16.7H63z M40.8,69.6h-3.3v16.7h3.3V69.6z M65.9,57.6
                        l-0.5,0c-9.5-1-16.9-9-16.9-18.8V10.5h10.3l0,28c0,4.1,2.8,7.8,6.7,8.7c0.2,0,0.3,0.1,0.5,0.1L65.9,57.6z M68.9,47.3
                        c0.2,0,0.3,0,0.4-0.1c3.8-1,6.7-4.6,6.7-8.7l-0.1-28h10.3v28.1c0,9.8-7.4,17.9-16.9,18.9l-0.4,0L68.9,47.3z"></path>
                                    </g>
        </svg>
    </div>
</div>

<nav class="navbar navbar-toggleable-sm navbar-light bg-light align-items-start">

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
    
        <div class="navigation collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                {% if request.journal.nav_home %}
                <li class="nav-item"><a href="{% url 'website_index' %}" class="nav-link">Home</a></li>{% endif %}

                <li class="nav-item"><a href="{% url 'mission_statement' %}" class="nav-link">Mission Statement</a></li>
                <li class="nav-item"><a href="{% url 'scientific_committee' %}" class="nav-link">Scientific Committee</a></li>
                <li class="nav-item"><a href="{% url 'call_for_papers' %}" class="nav-link">Call For Papers</a></li>
                <li class="nav-item"><a href="{% url 'imprint' %}" class="nav-link">Imprint</a></li>
                <li class="nav-item"><a href="{% url 'ethics' %}" class="nav-link">Publication Ethics and Publication Malpractice Statement</a></li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="About"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"">About</a>
                    <div class="dropdown-menu" aria-labelledby="About">
                            <a href="{% url 'mission_statement' %}" class="dropdown-item">Mission Statement</a>
                            <a href="{% url 'scientific_committee' %}" class="dropdown-item">Scientific Committee</a>
                            <a href="{% url 'call_for_papers' %}" class="dropdown-item">Call For Papers</a>
                            <a href="{% url 'imprint' %}" class="dropdown-item">Imprint</a>
                            <a href="{% url 'ethics' %}" class="dropdown-item">Publication Ethics and Publication Malpractice Statement</a>
                   </div>

                </li>

                
                {% if request.journal.nav_news %}
                    <li class="nav-item"><a href="{% url 'core_news_list' %}" class="nav-link">News</a></li>{% endif %}
    
                {% if request.journal.nav_articles %}
                    <li class="nav-item"><a href="{% url 'journal_articles' %}" class="nav-link">Articles</a>
                    </li>{% endif %}
                {% if request.journal.nav_issues %}
                    <li class="nav-item"><a href="{% url 'journal_issues' %}" class="nav-link">Issues</a></li>{% endif %}
    
    
                {% if journal_settings.general.enable_editorial_display %}
                    {% if journal_settings.general.multi_page_editorial %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="" id="editorial_team"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Editorial Team
                        </a>
                        <div class="dropdown-menu" aria-labelledby="editorial_team">
                            {% for group in request.journal.editorial_groups %}
                                <a href="{% url 'editorial_team_group' group.pk %}" class="dropdown-item">{{ group.name }}</a>
                            {% endfor %}
                        </div>
                    </li>
                    {% else %}
                    <li class="nav-item"><a href="{% url 'editorial_team' %}" class="nav-link">Editorial Team</a>
                    </li>
                    {% endif %}
                {% endif %}
    
                {% if request.journal.nav_sub %}
                    <li class="nav-item"><a href="{% url 'journal_submissions' %}" class="nav-link">Submission</a>
                    </li>{% endif %}
                            {% for item in navigation_items %}
                    {% if item.has_sub_nav %}
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="" id="{{ item.link_name|slugify }}"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                {{ item.link_name }}
                            </a>
                            <div class="dropdown-menu" aria-labelledby="{{ item.link_name|slugify }}">
                                {% for subnav in item.sub_nav_items %}
                                    <a href="{{ subnav.url }}" class="dropdown-item">{{ subnav.link_name }}</a>
                                {% endfor %}
                            </div>
                        </li>
                    {% else %}
                        <li class="nav-item"><a href="{{ item.url }}" class="nav-link">{{ item.link_name }}</a></li>
                    {% endif %}
                {% endfor %}
<!--
                {% if request.journal.nav_contact %}
                    <li class="nav-item"><a href="{% url 'contact' %}" class="nav-link">Contact</a></li>{% endif %}
-->
                {% hook 'nav_block' %}
                {% if request.journal.nav_start and not journal_settings.general.disable_journal_submission %}
                    <li class="nav-item"><a href="{% url 'submission_start' %}" class="nav-link"><i
                            class="fa fa-cloud-upload"></i> Start
                        Submission</a></li>{% endif %}
                {% if request.journal.nav_review %}
                    <li class="nav-item"><a href="{% url 'become_reviewer' %}" class="nav-link"><i class="fa fa-trophy"></i>
                        Become a Reviewer</a>
                    </li>{% endif %}
                {% if request.user.is_authenticated %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="" id="user"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Account
                        </a>
                        <div class="dropdown-menu" aria-labelledby="user">
                            <a class="dropdown-item" href="{% url 'core_dashboard' %}">Dashboard</a>
                            {% if not journal_settings.general.disable_journal_submission %}<a class="dropdown-item" href="{% url 'submission_start' %}">Submit</a>{% endif %}
                            {% user_has_role request 'editor' as user_is_editor %}
                            {% if user_is_editor or request.user.is_staff %}
                                <a class="dropdown-item" href="{% url 'kanban' %}">Kanban</a>
                                <a class="dropdown-item" href="{% url 'core_manager_index' %}">Manager</a>
                                {% if request.resolver_match.url_name and request.resolver_match.url_name == 'article_view' and article %}
                                    <a class="dropdown-item" href="{% url 'manage_archive_article' article.pk %}">Edit
                                        Article</a>
                                {% endif %}
                            {% endif %}
                            {% if request.user.is_staff %}
                                <a class="dropdown-item" href="/admin/">Admin</a>
                            {% endif %}
                            <a class="dropdown-item" href="{% url 'core_edit_profile' %}">Profile</a>
                            <a class="dropdown-item" href="{% url 'core_logout' %}">Logout</a>
                        </div>
                    </li>
                {% else %}
                    <li class="nav-item"><a href="{% url 'core_login' %}" class="nav-link"><i class="fa fa-sign-in">
                        &nbsp;</i>Login</a></li>
                    <li class="nav-item"><a href="{% url 'core_register' %}" class="nav-link"><i class="fa fa-user-plus">
                        &nbsp;</i>Register</a></li>
                {% endif %}


            <li class="nav-item">
            <form method="POST" action="{% url 'search' %}" class="form-inline mt-2 mt-md-0">
                    {% csrf_token %}
                    <input id="searchField" class="form-control mr-sm-2" type="text" placeholder="Search" name="article_search">
                    <input type="hidden" name="sort" value="title">
                    <button id="searchBtn" class="btn my-2 my-sm-0" type="submit">Search</button>
            </form>            
            </li>
            {% if journal_settings.general.switch_language %}
            <li class="nav-item">
                    <form class="form-inline mt-2 mt-md-0" action="{% url 'set_language' %}" method="post">{% csrf_token %}
                    <input name="next" type="hidden" value="{{ request.PATH }}"/>
                    <select name="language" onchange="this.form.submit()">
                        {% get_current_language as LANGUAGE_CODE %}
                        {% get_available_languages as LANGUAGES %}
                        {% get_language_info_list for LANGUAGES as languages %}
                        {% for language in languages %}
                            <option value="{{ language.code }}"{% if language.code == LANGUAGE_CODE %}
                                    selected{% endif %}>
                                {{ language.name_local }} ({{ language.code }})
                            </option>
                        {% endfor %}
                    </select>
                </form>
            </li>

            {% endif %}
            </ul>


        </div>
    </nav>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
        $('#searchBtn').prop('disabled',true);
        if($('#searchField').val().length <3 )
                $('#searchBtn').prop('disabled',true);            
            else
                $('#searchBtn').prop('disabled',false);

        $('#searchField').keyup(function()
        {
            if($(this).val().length <3 )
                $('#searchBtn').prop('disabled',true);            
            else
                $('#searchBtn').prop('disabled',false);
        })
    });
    </script>






